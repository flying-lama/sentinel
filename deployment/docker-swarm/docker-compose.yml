version: '3.8'

services:
  sentinel:
    image: ghcr.io/flying-lama/sentinel:latest
    environment:
      - SENTINEL_LOG_LEVEL=INFO
      - SENTINEL_ORCHESTRATION_TYPE=swarm
      - SENTINEL_DOMAIN=example.com
      - SENTINEL_RECORD=lb
      # INWX
      # - SENTINEL_DNS_PROVIDER=inwx
      # - SENTINEL_INWX_USER=your_username
      # Bunny
      # - SENTINEL_DNS_PROVIDER=bunny
      # - SENTINEL_BUNNY_API_KEY=your-api-key
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    secrets:
      - source: inwx_password
        target: /run/secrets/inwx_password
        mode: 0400
    deploy:
      mode: global
      placement:
        constraints:
          - node.role == manager
    restart: unless-stopped

secrets:
  inwx_password:
    external: true